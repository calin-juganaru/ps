close all;
clear all;

sine = ...
[   ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  ...
    18 87 165 263 385 506 619 720 803 866 902 914 899 856 795 702 587 455 309 159 15 0  ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 47  ...
    132 248 365 481 598 703 790 855 899 915 902 865 800 715 611 482 339 184 31 0 0 0  ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 25 99 181  ...
    308 446 562 668 763 837 890 911 910 881 829 745 647 527 388 234 84 0 0 0 0 0  ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 56 134 238 344  ...
    497 627 729 817 872 908 918 895 854 783 691 572 438 298 141 0 0 0 0 0 0 0  ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 42 110 212 326 442 557  ...
    685 786 856 897 919 907 868 808 724 615 486 348 199 47 0 0 0 0 0 0 0 0  ...
];

sine /= max(sine);
sine = sine - shift(sine, -21);
sine = sine(1 : 200);

figure;
subplot(2, 2, 1);
#stem(sine); hold on;
plot(sine);
axis([0 200 -1.1 1.1]);

DFT = fftshift(fft(sine));
subplot(2, 2, 2); stem(abs(DFT));

aux = max(DFT);
for i = 1 : length(DFT)
    if abs(DFT(i)) < 3 * aux / 4
        DFT(i) = 0;
    endif
endfor

subplot(2, 2, 4); stem(abs(DFT));

subplot(2, 2, 3);
plot(real(ifft(ifftshift(DFT))));
axis([0 200 -1.1 1.1]);
print -djpg ./DFT_HPF.jpg;

result = ...
[   ...
    405.86 240.96 108.69 25.01 0.00 36.69 130.64 270.54 439.49 617.14 782.04 914.31 997.99 1023.00 986.31 892.36 752.46 583.51 405.86 240.96 108.69  ...
    25.01 0.00 36.69 130.64 270.54 439.49 617.13 782.04 914.31 997.99 1023.00 986.31 892.36 752.47 583.51 405.86 240.96 108.69 25.01 0.00 36.69  ...
    130.64 270.53 439.49 617.14 782.04 914.30 997.99 1023.00 986.31 892.36 752.47 583.51 405.87 240.97 108.69 25.01 0.00 36.69 130.65 270.53 439.49  ...
    617.13 782.03 914.31 997.99 1023.00 986.31 892.36 752.47 583.51 405.86 240.97 108.69 25.01 0.00 36.69 130.64 270.54 439.49 617.13 782.04 914.31  ...
    997.99 1023.00 986.31 892.36 752.48 583.51 405.86 240.97 108.69 25.01 0.00 36.68 130.64 270.53 439.50 617.15 782.04 914.30 997.99 1023.00 986.31  ...
    892.36 752.46 583.50 405.88 240.97 108.70 25.01 0.00 36.69 130.64 270.53 439.50 617.13 782.03 914.30 998.00 1023.00 986.31 892.36 752.48 583.51  ...
    ...
];

figure; plot(result);
axis([0 length(result) 0 1024]);
print -djpg ./test.jpg;